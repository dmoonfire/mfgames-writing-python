#!/usr/bin/env python

#
# Documentation
#

#
# Imports
#

# System Imports
import argparse
import logging

# Local Imports
#from mfgames.creole.docbook import setup_creole_to_docbook
import mfgames.creole.docbook

#
# Constants
#

LOG_FORMAT = "%(asctime)-15s %(message)s"

#
# Logging
#

# Set up the logging to use a common format.
logging.basicConfig(format=LOG_FORMAT, level=logging.DEBUG)

#
# Processes
#

processes = {
    'docbook' : mfgames.creole.docbook.CreoleDocbookConvertProcess(),
    }

#
# Argument Parsing
#

# Set up the primary parser.
parser = argparse.ArgumentParser(
    description='Manipulate and convert Creole documents.')
subparsers = parser.add_subparsers()

# Go through the processes and add each one's subparser.
for process_name, process in processes.iteritems():
    # Add this subparser to the primary parser.
    process_parser = subparsers.add_parser(
        process_name,
        help=process.help)
    process_parser.set_defaults(name=process_name)

    # Add the process-specific arguments to the parser.
    process.setup_arguments(process_parser)

## Setup the secondary parsers.
#setup_creole_to_docbook(subparsers)
#

# Process the arguments given on the command line. Then, use the
# default to figure out the process name which is then used to call
# the process() method in that Process class.
args = parser.parse_args()
selected_name = args.name
selected_process = processes[selected_name]
selected_process.process(args)
